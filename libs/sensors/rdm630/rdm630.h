#ifndef RDM6300_H
#define RDM6300_H
#include <serial.h>
#include <portmanager.h>
#include <macros.h>
#include <vector>

class Rdm6300
{
public:
    //---- Methods ----//
    Rdm6300();
    ~Rdm6300();
    bool attachTo(enum SerialPort serial, enum UART baud);
    bool isNewCard();
    std::vector<uint8_t> getData();
    bool setBuzzerPin(uint8_t pin);

    //---- Variables ----//
private:
    //---- Methods ----//
    bool calcCrc(std::vector<uint8_t> &buff);
    bool isValidPacket(std::vector<uint8_t> &data);

    void buzzerIncoming();
    void buzzerOutcoming();
    void buzzerDenied();

    //---- Variables ----//
    Serial *serial;
    std::vector<uint8_t> lastCard;
    Pin *buzzer;
};

#endif
